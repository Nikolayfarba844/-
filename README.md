# Основы Статистики

# Часть 1

# Генеральная совокупность и выборка

* Генеральная совокупность (от лат. generis — общий, родовой) — совокупность всех объектов, относительно которых предполагается делать выводы при изучении конкретной задачи. Далее ГС.

* Репрезентативная выборка – это такая выборка, в которой все основные признаки генеральной совокупности, из которой извлечена данная выборка, представлены приблизительно в той же пропорции или с той же частотой, с которой данный признак выступает в этой генеральной совокупности.

# Способы репрезентативной выборки:

* Простая случайная выборка (simple random sample)

* Стратифицированная выборка (stratified sample) – разделение ГС на страты (группы) а оттуда уже делается случайная выборка.

* Групповая выборка (cluster sample) – похожие группы выбираются из выборки и далее делается случайная выборка (например, районы одного города)

# Типы переменных

# Количественные – измеряемое (например, рост):

* Непрерывные – переменная принимает любое значение на опр. промежутке;

* Дискретные – только определенные значения (3.5 ребенка в семье не будет).

* Номинативные (= качественные) – разделение испытуемых на группы, цифры как маркеры (например: 1 -женщины, 2 – мужчины). Цифры как имена групп, не для расчетов.

* Ранговые – похоже на номинативные, только возможны сравнения (быстрее/медленнее и т.п.)

# Описательная статистика

# Глоссарий:

* Эмпирические данные - данные полученные опытным путём.

* Описательная (дескриптивная) статистика - обработка данных полученных эмпирическим путём и их систематизация, наглядное представление в форме графиков, таблиц, а также их количественное описание посредством основных статистических показателей.

* Распределение вероятностей - это закон, описывающий область значений случайной величины и вероятность её появления (частоту) в данной области. То есть насколько часто X появляется в данном диапазоне значений.

* Гистограмма частот - ступенчатая функция показывающая насколько часто вероятно появление величины в указанном диапазоне значений.

# Меры центральной тенденции
# тип описательной статистики

# Мода
* Это значение признака, которое встречается максимально часто. В выборке может быть несколько или одна мода.

# Медиана
* Это значение признака, которое делит упорядочное множество попалам. Если множество содержит чётное количество элементов, то берётся среднее из двух серединных элементов упорядочного множества.

# Среднее значение
* Cумма всех значений измеренного признака делится на количество измеренных значений.

# Меры центральной тенденции
* тип описательной статистики

# Свойства среднего значения
* Mx+c=∑ni=1(xi+c)n=∑ni=1xin+∑ni=1cn=Mx+ncn=Mx+c
* Mx∗c=∑ni=1(xi∗c)n=c∗∑ni=1xin=c∗Mx
* ∑i=1n(xi−Mx)=nMx−nMx=0

# Меры изменчивости
# Размах
* Это разность между максимальным и минимальным значениям выборки. Крайне чувствителен к взбросам.

# Дисперсия
* Это средний квадрат отклонений индивидуальных значений признака от их средней величины

# Для генеральной совокупности

* D=∑ni=1(xi−Mx)2n
# Среднеквадратическое отклонение
* σ=D‾‾√
# Для выборки
* D=∑ni=1(xi−Mx)2n−1
# где 1 это количество степеней свободы Важно отменить, что среднеквадратическое отклонение для выборки обозначают по другому, как sd - standart deviation

# Ликбез: Почему именно квадрат, а не модуль или куб?
* Могу предположить, что линейное отклонение более чувствительно выбросам, квадратичное менее, кубическое — ещё менее чувствительно. Попробовал посчитать для 3-х выборок: [1,2,3,4,5], [1,2,3,4,50] и [1,2,3,4,500]:

* Линейное: 2.5, 452.5 и 49502.5
* Квадратичное: 1.58, 21.27 и 222.49
* Кубическое: 1.36, 7.68, и 36.71
* Модуль не берут потому, что модуль - не гладкая функция. В нуле у модуля имеется "излом" из-за которого у производной происходит разрыв. А очень многие математические теоремы, которые наверняка потребуются дальше, работают только на гладких функциях.

* Вообще, с не гладкими функциями работать не любят. Там все становится сложнее. Поэтому берется квадрат. Source

# Свойства дисперсии
* Dx+c=Dx
* Dx∗c=Dx+c2
# Квартили распределения
* Квартили - это три точки(значения признака), которые делят упорядочное множество данных на 4 равные части.

* Box plot - такой вид диаграммы в удобной форме показывает медиану, нижний и верхний квартили, минимальное и максимальное значение выборки и выбросы.

* Квартили и inter quartile range используют, чтобы оценить наличие выбросов. Алгоритм расчета - посчитали квартили, посчитали разницу между ними, вычислили теоретический максимум и минимум, сравнили с имеющимся и выяснили есть ли у вас выбросы и сколько их. Если много, то нужно анализировать и решать брать ли их в выборку или нет.

# Нормальное распределение
# Коротко

* Унимодально
* Симметрично
* Отклонения наблюдений от среднего подчиняются определённому вероятностному закону
# Подробно

* Нормальное распределение возникает в результате воздействия множества факторов, вклад каждого из которых очень мал.

* Для облегчения этого восприятия в 1873 году Фрэнсис Гальтон сделал устройство, которое в последствии назвали Доской Галтона (или квинкункс). Суть простая: сверху по середине подаются шарики, которые при прохождении нескольких уровней (например, 10-ти) на каждом уровне сталкиваются с препятствием, и при каждом столкновении отскакивают либо влево, либо вправо (с равной вероятностью).

* Как вы догадываетесь, результатом прохождения - это распределение, стремящееся к нормальному!

# Z-преобразование
* Преобразование полученных данных в стандартную Z-шкалу (Z-scores) со средним значением = 0 и дисперсией = 1. Чтобы привести к такому виду из каждого наблюдения нужно отнять среднее значение и разделитьв на стандартное отклонение.

* Zi=xi−X¯sd
* Иногда нам необходимо рассчитать z - значение только для отдельно взятого наблюдения, чтоб выяснить насколько далеко оно отклоняется от среднего значения в единицах стандартного отклонения.

# Центральная предельная теорема
* Гласит, что множество средних выборок из генеральной совокупности (ГС необязательно иметь нормальное распределние) будут иметь нормальное распределение. Причём средняя этого распределения будет близко к средней генеральной совокупности, а стандарное отклонение этого распределение будет називаться стандарной ошибкой среднего (se).

* Зная стандартное отклонение ГС и размер выборки мы можем рассчитать стандартную ошибку среднего.

* se=σN‾‾√
* где N - размер выборки. Если размер выборки достаточно большой (>30) и она является репрезативна, то вместо стандарного отклонения ГС мы можем взять стандарное отклонение выборки.

* se=sdN‾‾√
* Стандартная ошибка среднего - это среднеквадратическое отклонение распределения выборочных средних

# PS Важное замечание о ЦПТ номер 2.
* Пожалую самый сложный момент - это как мы так взяли и заменили стандартное отклонение генеральной совокупности на выборочное. Ну и что с того, что у нас выборка объемом больше 30 наблюдений, что за магическое число такое?

* Все правильно, никакой магии не происходит. И совсем скоро мы в этом окончательно разберемся. Как только пройдем тему t - распределения во втором модуле. Вот тут я подробно расписал, как же нам нужно рассчитывать стандартную ошибку среднего, если мы не знаем стандартное отклонение в генеральной совокупности.

# Доверительные интервалы для среднего
* Если мы имеем некоторую выборку и ГС, то мы не можем точно знать среднюю ГС, зная только среднее выборки. Однако мы можем сказать, с некоторым процентом уверенности, в каком интервале лежит средняя ГС. Понятно дело, что для нас лучше, чтобы этот интервал был как можно меньше, как это сделать?

* Мы знаем, средняя средних выборок, стремится к средней ГС, также мы знаем, что стандартная ошибка среднего описывает стандартное отклонение распределения средних выборок. Если мы возьмём случайную выборку X и найдём её среднее X¯, а также вычислим стандартную ошибку se, то мы можем вычислить доверительный интевал [X¯−1.96∗se;X¯+1.96∗se] который описывает среднюю ГС с некотором интервале с 95% доверия.

* Загадочное число 1,96 это количество сигм σ в нормальном распределение, необходимые, чтобы охватить 95% значений в этом распределнии.

# Если мы рассчитали 95% доверительный интервал для среднего значения, это значит:
* Среднее значение в генеральной совокупности точно принадлежит рассчитанному доверительному интервалу.
* Мы можем быть на 95% уверены, что среднее значение в генеральной совокупности принадлежит рассчитанному доверительному интервалу.
* Если многократно повторять эксперимент, для каждой выборки рассчитывать свой доверительный интервал, то в 95 % случаев истинное среднее будет находиться внутри доверительного интервала.
* Среднее значение в генеральной совокупности точно превышает нижнюю границу 95% доверительного интервала.
* Если многократно повторять эксперимент, то 95 % выборочных средних значений будут принадлежать рассчитанному нами доверительному интервалу. да-да, тут просто надо представить это в уме
* Если из лекции усвоить разницу между средним ГС и средним выборки, а так же понять, что доверительный интервал строится для выборки, а не для ГС, то ответы в тесте легко определяются.

# Идея статистического вывода
* Статистическая проверка гипотез
* p-уровень значимости
* p-уровень значимости - это вероятность получить такие или более выраженные различия при условии, что в генеральной совокупности никаких различий на самом деле нет.

# Часть 2
# T-распределение
* Распределение Стьюдента по сути представляет собой сумму нескольких нормально распределенных случайных величин. Чем больше величин, тем больше верятность, что их сумма будет иметь нормальное распределение. Таким образом, количество суммируемых величин определяет важнейший параметр формы данного распредения - число степеней свободы.

# Сравнение двух средних. t-критерий Стьюдента
* t-критерий Стьюдента — общее название для статистических тестов, в которых статистика критерия имеет распределение Стьюдента. Наиболее часто t-критерии применяются для проверки равенства средних значений в двух выборках. Нулевая гипотеза предполагает, что средние равны (отрицание этого предположения называют гипотезой сдвига). Для применения данного критерия необходимо, чтобы исходные данные имели нормальное распределение.

* t=X1¯−X2¯se
* se=sd21n1+sd22n2‾‾‾‾‾‾‾‾‾‾‾√
* Откуда берётся такая формула se?:

* (se1)2=(sd1n1‾‾√)2=sd21n1
* То есть:

* se=sd21n1+sd22n2‾‾‾‾‾‾‾‾‾‾‾√=se21+se22‾‾‾‾‾‾‾‾‾√
* причем ответ на вопрос, почему верно это равенство, кроется в свойстве дисперсии: дисперсия суммы независимых случайных величин равна сумме их дисперсий. а отклонение - это корень из дисперсии. отсюда ваша последняя формула

# Примеры применения t-критерий Стьюдента
* Пример 1. Первая выборка — это пациенты, которых лечили препаратом А. Вторая выборка — пациенты, которых лечили препаратом Б. Значения в выборках — это некоторая характеристика эффективности лечения (уровень метаболита в крови, температура через три дня после начала лечения, срок выздоровления, число койко-дней, и т.д.) Требуется выяснить, имеется ли значимое различие эффективности препаратов А и Б, или различия являются чисто случайными и объясняются «естественной» дисперсией выбранной характеристики.

* Пример 2. Первая выборка — это значения некоторой характеристики состояния пациентов, записанные до лечения. Вторая выборка — это значения той же характеристики состояния тех же пациентов, записанные после лечения. Объёмы обеих выборок обязаны совпадать; более того, порядок элементов (в данном случае пациентов) в выборках также обязан совпадать. Такие выборки называются связными. Требуется выяснить, имеется ли значимое отличие в состоянии пациентов до и после лечения, или различия чисто случайны.

* Пример 3. Первая выборка — это поля, обработанные агротехническим методом А. Вторая выборка — поля, обработанные агротехническим методом Б. Значения в выборках — это урожайность. Требуется выяснить, является ли один из методов эффективнее другого, или различия урожайности обусловлены случайными факторами.

* Пример 4. Первая выборка — это дни, когда в супермаркете проходила промо-акция типа А (красные ценники со скидкой). Вторая выборка — дни промо-акции типа Б (каждая пятая пачка бесплатно). Значения в выборках — это показатель эффективности промо-акции (объём продаж, либо выручка в рублях). Требуется выяснить, какой из типов промо-акции более эффективен.

# Однофакторный дисперсионный анализ
* Рассмотренный ранее t-критерий Стьюдента (равно как и его непараметрические аналоги) предназначен для сравнения исключительно двух совокупностей. В таком случае мы можем применять однофакторный дисперсионный анализ. Та переменная, которая будет разделять наших испытуемых или наблюдения на группы (номинативная переменная с нескольким градациями) называется независимой переменной. А та количественная переменная, по степени выраженности которой мы сравниваем группы, называется зависимая переменная.

* SStotal=∑j=1p∑i=1nj(xij−x¯)2=SSbetween+SSwithin
* SSbetween=∑j=1pnj(x¯j−x¯)2
* SSwithin=∑j=1p∑i=1nj(xij−x¯j)2

# Часть 3
* Корреляция
* Ковариация
(ко - совместная, вариация - изменчивость). Мера линейной зависимости двух случайных величин.

* Если ковариация положительна, то с ростом значений одной случайной величины, значения второй имеют тенденцию возрастать, а если знак отрицательный — то убывать.

* cov(X,Y)=∑(xi−x¯)(yi−x¯)N−1
* где N - количество случайных величин, а единица - количество степеней свободы.

* Однако только по абсолютному значению ковариации нельзя судить о том, насколько сильно величины взаимосвязаны, так как масштаб ковариации зависит от их дисперсий. Значение ковариации можно нормировать, поделив её на произведение среднеквадратических отклонений (квадратных корней из дисперсий) случайных величин. Полученная величина называется коэффициентом корреляции Пирсона, который всегда находится в интервале от −1 до 1:

* r(x,y)=cov(x,y)σxσy

# Регрессия с одной независимой переменной
# В этой и следующих главах мы научимся работать с одномерным регрессионным анализом, который позволяет проверять гипотезы о взаимосвязи одной количественной зависимой переменной и нескольких независимых.

* Сначала мы познакомимся с самым простым вариантом - простой линейной регрессией, при помощи которой можно исследовать взаимосвязь двух переменных. Затем перейдем к множественной регрессии с несколькими независимыми переменными.

* Линейная регрессия (англ. Linear regression) — используемая в статистике регрессионная модель зависимости одной (объясняемой, зависимой) переменной y от другой или нескольких других переменных (факторов, регрессоров, независимых переменных) x с линейной функцией зависимости.

* В общем виде функция линейной регрессии выглядит как:

* y=b0+b1x
* b0 - intercept значение пересечения линии с осью Y

* b1 - slope задаёт наклон линии регрессии

* строят регрессионную прямую методом наименьших квадратов (МНК)

# МНК - это способ нахождения оптимальных параметров линейной регресссии (b0, b1), таких, что сумма квадратов ошибок (остатков) была минимальная.

* Расчёт параметров идёт по таким формулам:

* b1=sdysdxrxy
* b0=Y¯−b1X¯

# Задача предсказания значений зависимой переменной
# Регрессионный анализ с несколькими независимыми переменными
# Множественная регрессия (Multiple Regression)
# Множественная регрессия позволяет исследовать влияние сразу нескольких независимых переменных на одну зависиммую.

# Требования к данным
* линейная зависимость переменных
* нормальное распредление остатков
* гомоскедастичность данных
* проверка на мультиколлиарность
* нормальное распределение переменных (желательно)



